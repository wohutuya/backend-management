# ====================== 应用基本配置 ======================
server:
  port: 8888
  servlet:
    context-path: /api   # 统一前缀，可根据需要改为 "" 去掉

spring:
  # ====================== 数据源（Druid） ======================
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://localhost:3306/backend_management?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: hutuya
    password: hu123123
    druid:
      # 连接池配置
      initial-size: 5
      min-idle: 5
      max-active: 20
      max-wait: 60000
      time-between-eviction-runs-millis: 60000
      min-evictable-idle-time-millis: 300000
      validation-query: SELECT 1
      test-while-idle: true
      test-on-borrow: false
      test-on-return: false

      # 开启 Druid 监控页面（访问 http://localhost:8888/api/druid）
      stat-view-servlet:
        enabled: true
        url-pattern: /druid/*
        login-username: admin
        login-password: 123456

      # Web 监控 + SQL防火墙
      web-stat-filter:
        enabled: true
        url-pattern: /*
        exclusions: "*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*"

  # ====================== Redis 配置 ======================
  data:
    redis:
      host: 127.0.0.1
      port: 6379
      password:      # 如果有密码填这里，没有就留空
      database: 0
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: -1ms
      timeout: 5000ms

  # ====================== MVC 配置 ======================
  mvc:
    pathmatch:
      matching-strategy: ant_path_matcher   # SpringBoot 2.6+ 必须加这一行，否则 Sa-Token 等路径会失效

# ====================== MyBatis-Plus 配置 ======================
mybatis-plus:
  mapper-locations: classpath*:mapper/**/*.xml
  type-aliases-package: com.kt.project.entity
  configuration:
    map-underscore-to-camel-case: true
    cache-enabled: false
    log-impl: org.apache.ibatis.logging.nologging.NoLoggingImpl   # 生产建议关闭，开发可改为 StdOutImpl 看SQL
    #log-impl: org.apache.ibatis.logging.stdout.StdOutImpl

  global-config:
    db-config:
      logic-delete-field: is_deleted     # 全局逻辑删除字段
      logic-delete-value: 1
      logic-not-delete-value: 0
      id-type: auto                      # 主键自增

# ====================== Sa-Token 权限认证配置 ======================
sa-token:
  # token 名称 (同时也是 cookie 名称)
  token-name: satoken
  # token 有效期（单位：秒） -1 代表永不过期
  timeout: 2592000   # 30天
  # token 最低活跃频率（单位：秒），如果 token 超过此时间没有被更新，则被视为被废弃
  active-timeout: -1
  # 是否允许同一账号并发登录（为 true 时允许一起登录, 为 false 时新登录挤掉旧登录）
  is-concurrent: true
  # 在多人登录同一账号时，是否共用一个 token（为 true 时所有登录共用一个 token, 为 false 时每次登录新建一个 token）
  is-share: true
  # token 风格
  token-style: uuid
  # 是否输出操作日志
  is-log: true
  # 是否从请求中读取 token（开启后支持 header 和 cookie 两种方式）
  is-read-header: true
  is-read-cookie: true

# ====================== 日志配置（开发阶段推荐） ======================
logging:
  level:
    com.kt.project: debug
    com.baomidou.mybatisplus: debug   # 生成代码时可以看到SQL
    cn.dev33.satoken: debug
